<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="l10n_ar_account_report_invoice_document" inherit_id="l10n_ar.report_invoice_document" priority="99">

            <xpath expr="//div[@id='informations']/div[2]" position="inside">
                <br/>
                <strong>Remitos: </strong>
                <span t-out="','.join(o.get_related_stock_pickings())"/>
            </xpath>
            <xpath expr="//t[@t-set='custom_footer']" position="before">
                <t t-set="date" t-value="report_date"/>
            </xpath>
            <xpath expr="//div[@id='payment_term']/parent::div/div[2]/t[3]" position="replace">
                <t t-if="o.l10n_latam_document_type_id.code in ['201', '206', '211', '202', '207', '212'] and o.partner_bank_id and o.partner_bank_id.acc_type == 'cbu'">
                    <br/><strong>CBU: </strong><span t-esc="o.partner_bank_id.acc_number or '' if o.partner_bank_id.acc_type == 'cbu' else ''"/>
                </t>            
            </xpath>
            <xpath expr="//table[@name='invoice_line_table']" position="before">

                <div class="row mt-4 border-dark border-top border-1 pt-1 text-center"/>

            </xpath>
        </template>
        <template id="tax_groups_totals" inherit_id="account.tax_groups_totals" priority="99">
            <xpath expr="//t[@t-as='amount_by_group']/tr/t" position="replace">
                <t t-if="tax_totals['display_tax_base'] or o.company_id.currency_id != o.currency_id">
                    <td>
                        <span t-esc="amount_by_group['tax_group_name']"/>
                        <span class="text-nowrap"> on
                            <t t-if="o.company_id.currency_id == o.currency_id">
                                <t t-esc="amount_by_group['formatted_tax_group_base_amount']"/>
                            </t>
                            <t t-else="">
                                <t t-esc="o.company_id.currency_id.symbol"/>
                                <t t-set="base_amount_in_currency" t-value="o.currency_id._convert(amount_by_group['tax_group_base_amount'], o.company_id.currency_id, o.company_id, date)"/>
                                <t t-out="base_amount_in_currency" t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 2}"/>
                            </t>
                        </span>
                    </td>
                    <td class="text-end o_price_total">
                        <span class="text-nowrap" t-esc="amount_by_group['formatted_tax_group_amount']"/>
                    </td>
                </t>
            </xpath>
        </template>
        <template id="tax_totals_variable_fixed_purchase" inherit_id="purchase.purchase_order_portal_content_totals_table">
            <xpath expr="//t[@t-call='purchase.document_tax_totals']" position="before">
                <t t-set="o" t-value="order"/>
                <t t-set="date" t-value="o.date_approve"/>
            </xpath>
        </template>
        <template id="tax_totals_variable_fixed_purchaseorder" inherit_id="purchase.report_purchaseorder_document">
            <xpath expr="//div[@id='total']" position="before">
                <t t-set="date" t-value="o.date_approve"/>
            </xpath>
        </template>

        <template id="tax_totals_variable_fixed_sale" inherit_id="sale.report_saleorder_document">
            <xpath expr="//t[@t-call='sale.document_tax_totals']" position="before">
                <t t-set="o" t-value="doc"/>
                <t t-set="date" t-value="o.date_order"/>
            </xpath>
        </template>
        <template id="tax_totals_variable_fixed_sale_order" inherit_id="sale.sale_order_portal_content_totals_table" priority="10">
            <xpath expr="//t[@t-call='#{sale_order._get_name_tax_totals_view()}']" position="before">
                <t t-set="o" t-value="sale_order"/>
                <t t-set="date" t-value="o.date_order"/>
            </xpath>
        </template>
    </data>
</odoo>